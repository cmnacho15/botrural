ğŸ“… Calendario - Bot Rural
Resumen
Sistema de calendario a corto plazo (60 dÃ­as) integrado con WhatsApp y la web.
Funcionalidades:

âœ… Crear actividades desde WhatsApp (audio o texto)
âœ… Crear actividades desde la web
âœ… Consultar pendientes desde WhatsApp
âœ… Ver calendario visual en la web
âœ… Marcar como realizada desde la web
âœ… Colores por estado (pendiente, hoy, vencida, realizada)
âœ… Zona horaria Uruguay


ğŸ“ Archivos incluidos
ArchivoDestinoDescripciÃ³nopenai-parser.tssrc/lib/openai-parser.tsParser actualizado con tipos CALENDARIOcalendarioHandler.tssrc/lib/whatsapp/handlers/calendarioHandler.tsHandlers de WhatsAppapi-calendario-route.tssrc/app/api/calendario/route.tsAPI GET/POSTapi-calendario-id-route.tssrc/app/api/calendario/[id]/route.tsAPI PATCH/DELETEcalendario-page.tsxsrc/app/dashboard/calendario/page.tsxPÃ¡gina del calendarioINTEGRACION-BOT-WEBHOOK.ts(instrucciones)CÃ³digo para integrar en el webhookINSTRUCCIONES-SIDEBAR.ts(instrucciones)CÃ³mo agregar al sidebar

ğŸš€ Pasos de implementaciÃ³n
1. Schema de Prisma
Agregar al final de prisma/schema.prisma:
prismamodel ActividadCalendario {
  id                String    @id @default(cuid())
  campoId           String
  usuarioId         String?
  
  titulo            String
  fechaProgramada   DateTime  @db.Date
  realizada         Boolean   @default(false)
  fechaRealizacion  DateTime?
  
  origen            String    @default("WEB")
  notas             String?
  
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  
  campo             Campo     @relation(fields: [campoId], references: [id], onDelete: Cascade)
  
  @@index([campoId])
  @@index([fechaProgramada])
  @@index([realizada])
}
Y en el modelo Campo agregar:
prismaactividadesCalendario ActividadCalendario[]
Luego ejecutar:
bashnpx prisma db push
2. Copiar archivos
bash# Parser actualizado
cp openai-parser.ts src/lib/openai-parser.ts

# Handler de WhatsApp
cp calendarioHandler.ts src/lib/whatsapp/handlers/calendarioHandler.ts

# API
mkdir -p src/app/api/calendario/[id]
cp api-calendario-route.ts src/app/api/calendario/route.ts
cp api-calendario-id-route.ts src/app/api/calendario/[id]/route.ts

# PÃ¡gina
mkdir -p src/app/dashboard/calendario
cp calendario-page.tsx src/app/dashboard/calendario/page.tsx
3. Actualizar el webhook
Ver archivo INTEGRACION-BOT-WEBHOOK.ts para el cÃ³digo exacto.
Resumen:

Importar los handlers de calendario
Agregar los casos CALENDARIO_CREAR y CALENDARIO_CONSULTAR antes del switch existente
Actualizar el mensaje de ayuda

4. Exportar handlers
En src/lib/whatsapp/index.ts, agregar:
typescriptexport {
  handleCalendarioCrear,
  handleCalendarioConsultar,
} from "./handlers/calendarioHandler"
5. Agregar al sidebar
En tu layout.tsx del dashboard, agregar el link:
typescript{ href: '/dashboard/calendario', icon: 'ğŸ“…', label: 'Calendario' }

ğŸ’¬ Ejemplos de uso por WhatsApp
Crear actividades:

"en 14 dÃ­as tengo que sacar tablilla"
"acordame el martes de llamar al veterinario"
"la semana que viene hay que vacunar"
"maÃ±ana llega el camiÃ³n"
"pasado maÃ±ana pagar al peÃ³n"
"el 20 revisar bebederos"

Consultar pendientes:

"calendario"
"pendientes"
"quÃ© tengo agendado"
"quÃ© hay para hacer"


ğŸ¨ Estados visuales
EstadoColorDescripciÃ³nPendienteğŸ”µ AzulActividad futuraHoyğŸŸ¡ AmarilloActividad para hoyVencidağŸ”´ RojoNo realizada y pasÃ³ la fechaRealizadağŸŸ¢ VerdeMarcada como completada

âš ï¸ Limitaciones

MÃ¡ximo 60 dÃ­as hacia adelante
Las actividades vencidas se muestran hasta 7 dÃ­as despuÃ©s
Solo se puede marcar como realizada desde la web